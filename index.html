<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juris AI | Relat√≥rio T√©cnico</title>
    <style>
        :root {
            --bg-color: #050910;
            --card-bg: #0f1623;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent: #3b82f6;
            --security: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #1e293b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; }
        
        body { 
            background-color: var(--bg-color); color: var(--text-primary); 
            line-height: 1.6; padding-bottom: 100px; overflow-x: hidden;
        }

        /* --- UTILS & HERO --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .animate-in { animation: fadeInUp 0.8s ease-out forwards; opacity: 0; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        header {
            background: rgba(5, 9, 16, 0.95); backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 100; padding: 20px 0; border-bottom: 1px solid var(--border);
        }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .brand { font-size: 1.5rem; font-weight: 800; }
        .brand span { color: var(--accent); }

        .hero { text-align: center; padding: 80px 0 60px; border-bottom: 1px solid var(--border); }
        .hero h1 { 
            font-size: 3.5rem; margin-bottom: 15px; 
            background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* --- STATS & FEATURE GRID --- */
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 60px; }
        .stat-card { background: var(--card-bg); padding: 20px; border: 1px solid var(--border); border-radius: 6px; }
        .stat-card strong { display: block; font-size: 1.5rem; color: white; }
        .stat-card span { font-size: 0.85rem; color: var(--text-secondary); text-transform: uppercase; }

        .feature-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 80px;
        }
        .f-item {
            background: rgba(15, 23, 42, 0.4); border: 1px solid var(--border); padding: 12px 15px;
            border-radius: 6px; display: flex; align-items: center; gap: 10px; font-size: 0.9rem;
        }
        .f-icon { color: var(--security); font-weight: bold; }

        /* --- TERMINAL (O BLOCO QUE VOLTOU) --- */
        .terminal-window {
            background: #0d1117; border: 1px solid #30363d; border-radius: 8px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); font-family: 'Consolas', monospace; overflow: hidden; margin-bottom: 80px;
        }
        .terminal-header { background: #161b22; padding: 10px 15px; border-bottom: 1px solid #30363d; display: flex; gap: 8px; align-items: center; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }
        .red { background: #ff5f56; } .yellow { background: #ffbd2e; } .green { background: #27c93f; }
        .terminal-body { padding: 20px; font-size: 0.9rem; color: #d1d5db; }
        .cmd { color: var(--security); margin-bottom: 10px; display: block; }
        .output-line { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .method { color: var(--accent); font-weight: bold; width: 60px; }
        .endpoint { color: #a5b4fc; flex: 1; }
        .status { color: var(--security); text-align: right; min-width: 100px; }
        .status.err { color: var(--danger); }
        .status.wait { color: var(--warning); }

        /* --- DB DIAGRAM --- */
        .db-diagram-wrap {
            position: relative; border: 1px solid var(--border); border-radius: 12px; overflow: hidden; margin-bottom: 80px;
            background: radial-gradient(1200px 600px at 50% 0%, rgba(59,130,246,0.1), transparent 60%), rgba(21, 27, 43, 0.3);
        }
        .db-diagram { position: relative; padding: 28px; }
        .db-head { position: relative; z-index: 3; display:flex; justify-content: space-between; gap: 20px; margin-bottom: 25px; }
        .db-head h3 { font-size: 1.35rem; color: white; margin-bottom: 5px; }
        .db-head p { color: var(--text-secondary); max-width: 800px; font-size: 0.95rem; }
        
        .db-legend { display:flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; }
        .pill { 
            display:inline-flex; align-items:center; gap: 8px; padding: 5px 12px; border-radius: 20px;
            border: 1px solid var(--border); background: rgba(15, 23, 42, 0.8); font-size: 0.75rem; color: var(--text-secondary);
        }
        .dot-leg { width: 8px; height:8px; border-radius:50%; }
        .d-core { background: #3b82f6; box-shadow: 0 0 10px rgba(59,130,246,0.5); }
        .d-gov { background: #10b981; box-shadow: 0 0 10px rgba(16,185,129,0.5); }
        .d-int { background: #f59e0b; box-shadow: 0 0 10px rgba(245,158,11,0.5); }

        .db-grid { position: relative; z-index: 3; display:grid; grid-template-columns: 1.15fr 1fr 1fr; gap: 20px; }
        .db-group { border: 1px solid var(--border); border-radius: 12px; background: rgba(11, 15, 25, 0.5); padding: 15px; }
        .db-group-title { display:flex; align-items:center; gap: 10px; color: white; font-weight: 700; margin-bottom: 15px; font-size: 0.9rem; }
        
        .db-card {
            background: rgba(21, 27, 43, 0.7); border: 1px solid var(--border); border-radius: 8px; padding: 12px; margin-bottom: 12px;
            transition: transform 0.2s;
        }
        .db-card:hover { transform: translateY(-2px); border-color: var(--accent); }
        .db-header { display:flex; justify-content: space-between; align-items:center; margin-bottom: 8px; }
        .db-name { font-family: 'Consolas', monospace; font-weight: 700; color: white; font-size: 0.95rem; }
        .badges { display:flex; gap: 5px; }
        .badge { 
            font-family: 'Consolas', monospace; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; 
            border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: #94a3b8; 
        }
        .b-pk { border-color: #f59e0b; color: #f59e0b; }
        .b-fk { border-color: #64748b; }
        .db-attrs { font-family: 'Consolas', monospace; font-size: 0.8rem; color: #cbd5e1; line-height: 1.5; }
        .db-attrs span { color: #64748b; }

        .db-svg { position: absolute; inset: 0; z-index: 2; pointer-events: none; }
        .db-svg path { fill: none; stroke: #3b82f6; stroke-width: 2; opacity: 0.4; }
        .db-svg path.gov { stroke: #10b981; } .db-svg path.int { stroke: #f59e0b; }

        /* --- TOUR --- */
        .section-header { margin: 80px 0 40px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
        .section-header h2 { font-size: 2rem; color: white; }
        
        .tour-row { display: flex; align-items: center; gap: 50px; margin-bottom: 100px; }
        .tour-row:nth-child(even) { flex-direction: row-reverse; }
        
        .tour-img { 
            flex: 1.4; border: 1px solid var(--border); border-radius: 8px; overflow: hidden; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); position: relative;
        }
        .tour-img img { width: 100%; display: block; transition: transform 0.3s; }
        .tour-img:hover img { transform: scale(1.02); }
        
        .tour-info { flex: 1; }
        .tour-info h3 { font-size: 1.6rem; color: white; margin-bottom: 20px; }
        .tour-bullets { list-style: none; }
        .tour-bullets li { margin-bottom: 15px; color: var(--text-secondary); display: flex; gap: 12px; font-size: 0.95rem; }
        .tour-bullets li::before { content: "‚ñπ"; color: var(--accent); font-weight: bold; }
        .tour-bullets strong { color: #e2e8f0; }

        @media (max-width: 900px) {
            .grid-4, .db-grid, .tour-row, .tour-row:nth-child(even) { grid-template-columns: 1fr; flex-direction: column; }
            .db-svg { opacity: 0.1; }
        }

        @media print {
            body { background: white; color: black; }
            .stat-card, .f-item, .db-diagram-wrap, .db-card, .db-group, .tour-img, .terminal-window { border: 1px solid #ccc; background: white; color: black; box-shadow: none; }
            .section-header h2, .hero h1, .tour-info h3, .db-head h3, .db-group-title, .db-name { color: black; }
            header, .btn-print, .db-svg, .terminal-header { display: none; }
            .tour-bullets strong, .pill, .badge, .cmd, .method, .endpoint, .status { color: black; border-color: #ccc; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container header-content">
            <div class="brand">JURIS <span>AI</span></div>
            <div style="font-size: 0.8rem; color: var(--text-secondary); border: 1px solid var(--border); padding: 5px 12px; border-radius: 20px;">
                Desenvolvido por <strong>Alberto</strong> | Janeiro 2026
            </div>
        </div>
    </header>

    <div class="container">
        
        <div class="hero animate-in">
            <h1>Jornada do Produto &<br>Engenharia de Software</h1>
            <p style="color: var(--text-secondary); max-width: 600px; margin: 0 auto;">
                Relat√≥rio t√©cnico detalhando as <strong>150 horas</strong> de desenvolvimento backend, l√≥gica de governan√ßa e infraestrutura de alta performance.
            </p>
        </div>

        <div class="grid-4 animate-in" style="animation-delay: 0.1s">
            <div class="stat-card"><strong>150h+</strong> <span>Development</span></div>
            <div class="stat-card"><strong>22</strong> <span>API Endpoints</span></div>
            <div class="stat-card"><strong>ACID</strong> <span>Database</span></div>
            <div class="stat-card"><strong style="color: var(--security)">99.9%</strong> <span>Uptime Target</span></div>
        </div>

        <div class="feature-grid animate-in" style="animation-delay: 0.2s">
            <div class="f-item"><span class="f-icon">‚úÖ</span> Login H√≠brido (OAuth)</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> Governan√ßa de Owner</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> CRUD Processual Completo</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> Kill Switch (Bloqueio)</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> Override Tempor√°rio</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> Calendar Sync</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> Prazos Cr√≠ticos</div>
            <div class="f-item"><span class="f-icon">‚úÖ</span> Drive Ready</div>
        </div>

        <div class="section-header animate-in"><h2>üóÑÔ∏è Arquitetura de Dados</h2></div>

        <div class="db-diagram-wrap animate-in" id="db-wrap">
            <svg class="db-svg" id="db-svg"></svg>
            <div class="db-diagram">
                <div class="db-head">
                    <div>
                        <h3>Modelo ER / Engenharia de Dados</h3>
                        <p>Modelo preparado para multi-tenant (isolamento por <code>office_id</code>) e integridade referencial estrita.</p>
                    </div>
                    <div class="db-legend">
                        <div class="pill"><span class="dot-leg d-core"></span><b>CORE</b> Jur√≠dico</div>
                        <div class="pill"><span class="dot-leg d-int"></span><b>INTEGRA√á√ÉO</b></div>
                        <div class="pill"><span class="dot-leg d-gov"></span><b>GOVERNAN√áA</b></div>
                    </div>
                </div>

                <div class="db-grid">
                    <div class="db-group">
                        <div class="db-group-title"><span class="dot-leg d-core"></span> CORE</div>
                        <div class="db-card" id="db-offices">
                            <div class="db-header"><div class="db-name">offices</div><div class="badges"><span class="badge b-pk">PK id</span></div></div>
                            <div class="db-attrs">name <span>(Tenant Raiz)</span></div>
                        </div>
                        <div class="db-card" id="db-clients">
                            <div class="db-header"><div class="db-name">clients</div><div class="badges"><span class="badge b-fk">FK office_id</span></div></div>
                            <div class="db-attrs">name, document, created_at</div>
                        </div>
                        <div class="db-card" id="db-processes">
                            <div class="db-header"><div class="db-name">processes</div><div class="badges"><span class="badge b-fk">FK client_id</span></div></div>
                            <div class="db-attrs">number, court, type, status</div>
                        </div>
                        <div class="db-card" id="db-deadlines">
                            <div class="db-header"><div class="db-name">deadlines</div><div class="badges"><span class="badge b-fk">FK process_id</span></div></div>
                            <div class="db-attrs">due_date, is_critical, responsible, completed</div>
                        </div>
                    </div>

                    <div class="db-group">
                        <div class="db-group-title"><span class="dot-leg d-int"></span> INTEGRA√á√ïES</div>
                        <div class="db-card" id="db-users">
                            <div class="db-header"><div class="db-name">users</div><div class="badges"><span class="badge b-fk">FK office_id</span></div></div>
                            <div class="db-attrs">email, password_hash, is_owner, role</div>
                        </div>
                        <div class="db-card" id="db-tokens">
                            <div class="db-header"><div class="db-name">google_tokens</div><div class="badges"><span class="badge b-fk">FK office_id</span></div></div>
                            <div class="db-attrs">access_token, refresh_token, scope, expiry</div>
                        </div>
                    </div>

                    <div class="db-group">
                        <div class="db-group-title"><span class="dot-leg d-gov"></span> GOVERNAN√áA</div>
                        <div class="db-card" id="db-blocks">
                            <div class="db-header"><div class="db-name">user_blocks</div><div class="badges"><span class="badge b-fk">FK user_id</span></div></div>
                            <div class="db-attrs">reason, blocked_by_system, blocked_at</div>
                        </div>
                        <div class="db-card" id="db-overrides">
                            <div class="db-header"><div class="db-name">office_overrides</div><div class="badges"><span class="badge b-fk">FK office_id</span></div></div>
                            <div class="db-attrs">reason, unlocked_by, expires_at</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-header animate-in"><h2>üíª Backend & API Logs</h2></div>

        <div class="terminal-window animate-in">
            <div class="terminal-header">
                <div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div>
                <span style="font-size: 0.8rem; color: #8b949e; margin-left: 10px;">root@juris-ai:~/backend-service</span>
            </div>
            <div class="terminal-body">
                <span class="cmd">> uvicorn main:app --workers 4 --host 0.0.0.0</span>
                <br>
                <div style="color: #64748b; margin-bottom: 10px;">INFO: Server started. Environment: PRODUCTION</div>
                
                <div class="output-line"><span class="method">POST</span> <span class="endpoint">/api/v1/auth/google/callback</span> <span class="status">200 OK</span></div>
                <div class="output-line"><span class="method">GET</span> <span class="endpoint">/api/v1/governance/status?office_id=14</span> <span class="status err">403 LOCKED</span></div>
                <div class="output-line"><span class="method">POST</span> <span class="endpoint">/api/v1/governance/override</span> <span class="status">201 CREATED</span></div>
                <div class="output-line"><span class="method">GET</span> <span class="endpoint">/api/v1/deadlines?filter=critical</span> <span class="status">200 OK</span></div>
                <div class="output-line"><span class="method">POST</span> <span class="endpoint">/api/v1/integrations/calendar/sync</span> <span class="status wait">202 ACCEPTED</span></div>
                <div class="output-line"><span class="method">GET</span> <span class="endpoint">/api/v1/drive/files/list</span> <span class="status">200 OK</span></div>
                <br>
                <span class="cmd">> _</span>
            </div>
        </div>

        <div class="section-header animate-in"><h2>üëÅÔ∏è Tour de Funcionalidades</h2></div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3>1. Seguran√ßa & Identidade</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Login H√≠brido (Email/Senha + Google OAuth).</li>
                    <li><strong>Backend:</strong> Valida√ß√£o Stateless via Tokens JWT. API checa cada requisi√ß√£o.</li>
                    <li><strong>Valor:</strong> Garante que apenas o escrit√≥rio correto acesse os dados.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="login.png" alt="Tela de Login"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3>2. OAuth Google (Consentimento)</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Fluxo de autoriza√ß√£o nativo do Google.</li>
                    <li><strong>Backend:</strong> OAuth 2.0 com persist√™ncia de tokens.</li>
                    <li><strong>Valor:</strong> Integra√ß√£o Workspace leg√≠tima, sem gambiarra.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="login_google.png" alt="Fluxo OAuth Google"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3 style="color: #ef4444;">3. Governan√ßa: "Kill Switch"</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Bloqueio total da tela em caso de inadimpl√™ncia.</li>
                    <li><strong>Backend:</strong> O bloqueio √© estrutural (Middleware). A API rejeita conex√µes (403).</li>
                    <li><strong>Valor:</strong> Prote√ß√£o total do ativo SaaS e garantia de conformidade.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="escritorio_bloqueado.png" alt="Tela de Bloqueio"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3 style="color: var(--warning);">4. Evid√™ncia do Override</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Confirma√ß√£o do desbloqueio com timestamp de expira√ß√£o.</li>
                    <li><strong>Backend:</strong> Override com <code>expires_at</code>; ao expirar, volta a bloquear.</li>
                    <li><strong>Valor:</strong> Flexibilidade controlada: libera quando precisa, sem abrir brecha.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="desbloqueio_temporario.png" alt="Override tempor√°rio"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3>5. Fluxo Operacional (Core)</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Sele√ß√£o de processo e cria√ß√£o de prazo em painel unificado.</li>
                    <li><strong>Backend:</strong> Consist√™ncia por integridade referencial (FKs).</li>
                    <li><strong>Valor:</strong> Velocidade no dia a dia: menos telas, menos cliques.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="selecionar_processo.png" alt="Sele√ß√£o de processo"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3>6. Dashboard de Prazos</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Tags visuais de urg√™ncia (Vencido, Hoje, Cr√≠tico).</li>
                    <li><strong>Backend:</strong> Motor de c√°lculo baseado na data atual e regras do CPC.</li>
                    <li><strong>Valor:</strong> Prioriza√ß√£o visual imediata, reduzindo risco de perdas.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="dashboard.png" alt="Dashboard de Prazos"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3>7. Evid√™ncia Google Calendar</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Prazos viram eventos detalhados com lembretes na agenda.</li>
                    <li><strong>Backend:</strong> Calendar API v3, payload rico com metadados do prazo.</li>
                    <li><strong>Valor:</strong> Sem retrabalho: o jur√≠dico vive na agenda.</li>
                </ul>
            </div>
            <div class="tour-img"><img src="apigoogle_calendar.png" alt="Calendar Integration"></div>
        </div>

        <div class="tour-row animate-in">
            <div class="tour-info">
                <h3>8. Drive (Conex√£o e Valida√ß√£o)</h3>
                <ul class="tour-bullets">
                    <li><strong>Interface:</strong> Conectar Drive e obter status imediato.</li>
                    <li><strong>Backend:</strong> Drive API v3 + valida√ß√£o de acesso.</li>
                    <li><strong>Valor:</strong> Base para gest√£o documental e futura IA (RAG).</li>
                </ul>
            </div>
            <div class="tour-img"><img src="drive.png" alt="Drive Integration"></div>
        </div>

        <div style="text-align: center; margin-top: 60px;">
            <button onclick="window.print()" style="background: var(--text-primary); color: var(--bg-color); border: none; padding: 16px 45px; border-radius: 6px; font-weight: 700; cursor: pointer;">
                üñ®Ô∏è Imprimir Relat√≥rio Executivo
            </button>
        </div>

    </div>

    <script>
      (function () {
        const wrap = document.getElementById("db-wrap");
        const svg = document.getElementById("db-svg");
        if (!wrap || !svg) return;

        const edges = [
          { from: "db-offices", to: "db-users", cls: "int" },
          { from: "db-offices", to: "db-clients", cls: "core" },
          { from: "db-clients", to: "db-processes", cls: "core" },
          { from: "db-processes", to: "db-deadlines", cls: "core" },
          { from: "db-offices", to: "db-tokens", cls: "int" },
          { from: "db-offices", to: "db-blocks", cls: "gov" },
          { from: "db-offices", to: "db-overrides", cls: "gov" },
          { from: "db-users", to: "db-blocks", cls: "gov" },
        ];

        function getAnchor(el, side) {
            const r = el.getBoundingClientRect(); const w = wrap.getBoundingClientRect();
            const xBase = r.left - w.left; const yBase = r.top - w.top;
            if (side === 'right') return { x: xBase + r.width, y: yBase + r.height / 2 };
            if (side === 'left') return { x: xBase, y: yBase + r.height / 2 };
            if (side === 'top') return { x: xBase + r.width / 2, y: yBase };
            return { x: xBase + r.width / 2, y: yBase + r.height };
        }

        function pickAnchors(fromEl, toEl) {
            const fr = fromEl.getBoundingClientRect(); const tr = toEl.getBoundingClientRect();
            if (Math.abs(fr.left - tr.left) > 100) {
                return fr.left < tr.left ? [getAnchor(fromEl, 'right'), getAnchor(toEl, 'left')] : [getAnchor(fromEl, 'left'), getAnchor(toEl, 'right')];
            }
            return fr.top < tr.top ? [getAnchor(fromEl, 'bottom'), getAnchor(toEl, 'top')] : [getAnchor(fromEl, 'top'), getAnchor(toEl, 'bottom')];
        }

        function bezierPath(a, b) {
            const dx = Math.abs(b.x - a.x) * 0.5;
            const dy = Math.abs(b.y - a.y) * 0.5;
            const c1 = Math.abs(b.x - a.x) > Math.abs(b.y - a.y) ? { x: a.x + dx, y: a.y } : { x: a.x, y: a.y + dy };
            const c2 = Math.abs(b.x - a.x) > Math.abs(b.y - a.y) ? { x: b.x - dx, y: b.y } : { x: b.x, y: b.y - dy };
            return `M ${a.x} ${a.y} C ${c1.x} ${c1.y}, ${c2.x} ${c2.y}, ${b.x} ${b.y}`;
        }

        function draw() {
            const w = wrap.clientWidth; const h = wrap.clientHeight;
            svg.setAttribute("width", w); svg.setAttribute("height", h); svg.setAttribute("viewBox", `0 0 ${w} ${h}`);
            while (svg.firstChild) svg.removeChild(svg.firstChild);
            
            edges.forEach(e => {
                const f = document.getElementById(e.from); const t = document.getElementById(e.to);
                if (!f || !t) return;
                const [a, b] = pickAnchors(f, t);
                const p = document.createElementNS("http://www.w3.org/2000/svg", "path");
                p.setAttribute("d", bezierPath(a, b));
                if (e.cls === "gov") p.classList.add("gov"); if (e.cls === "int") p.classList.add("int");
                svg.appendChild(p);
            });
        }

        let t = null;
        function scheduleDraw() { if(t) cancelAnimationFrame(t); t = requestAnimationFrame(draw); }
        
        window.addEventListener("resize", scheduleDraw);
        window.addEventListener("scroll", scheduleDraw);
        scheduleDraw();
        setTimeout(scheduleDraw, 500);
      })();
    </script>
</body>
</html>